{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../components/Layout';\nimport fetch from 'isomorphic-unfetch';\nimport LatestNews from '../components/LatestNews';\nimport HomeNews from '../components/HomeNews';\nimport AdminPanel from '../components/AdminPanel';\nimport InbetweenOne from '../components/InbetweenOne';\nimport Newsletter from '../components/Newsletter';\nimport { useKeenSlider } from 'keen-slider/react';\nimport Item from '../models/itemModel';\nimport dbConnect from '../utils/dbConnection';\nimport { useState, useEffect } from 'react';\n\nconst fetcher = url => fetch(url).then(res => res.json());\n\nconst Index = props => {\n  const {\n    0: homeData,\n    1: setHomeData\n  } = useState([]); // data to which I add more n more elements\n\n  const {\n    0: btnChangedData,\n    1: setBtnChangedData\n  } = useState([]); // based on btn type set new data from homeData\n\n  const {\n    0: currentBtnClicked,\n    1: setCurrentBtnClicked\n  } = useState(''); // type of btn\n\n  const {\n    0: currentPage,\n    1: setCurrentPage\n  } = useState(2); // current page number\n\n  const {\n    0: mainPage,\n    1: setMainPage\n  } = useState(true); // based on value I disappear top navbar line elements (left)\n  // slider configuration ***\n\n  const [pause, setPause] = React.useState(false);\n  const timer = React.useRef();\n  const [sliderRef, slider] = useKeenSlider({\n    loop: true,\n    duration: 2000,\n    dragStart: () => {\n      setPause(true);\n    },\n    dragEnd: () => {\n      setPause(false);\n    }\n  });\n  React.useEffect(() => {\n    sliderRef.current.addEventListener('mouseover', () => {\n      setPause(true);\n    });\n    sliderRef.current.addEventListener('mouseout', () => {\n      setPause(false);\n    });\n  }, [sliderRef]);\n  React.useEffect(() => {\n    timer.current = setInterval(() => {\n      if (!pause && slider) {\n        slider.next();\n      }\n    }, 3500);\n    return () => {\n      clearInterval(timer.current);\n    };\n  }, [pause, slider]); // end of slider configuration ***\n\n  useEffect(() => {\n    setHomeData(props.homeNewsData);\n  }, []);\n\n  const latest = () => {\n    let oldData = [...homeData];\n    let time = new Date(Date.now() - 86400000 * 5).toISOString();\n    let newData = oldData.filter(el => el.createdAt > time);\n    setBtnChangedData(newData);\n    setCurrentBtnClicked('latest');\n  };\n\n  const popular = () => {\n    let oldData = [...homeData];\n    let newData = oldData.filter(el => el.popularity >= 2);\n    setBtnChangedData(newData);\n    setCurrentBtnClicked('popular');\n  };\n\n  const under = () => {\n    let oldData = [...homeData];\n    let newData = oldData.filter(el => el.price <= 10);\n    setBtnChangedData(newData);\n    setCurrentBtnClicked('under');\n  };\n\n  const random = () => {\n    let oldData = [...homeData];\n\n    function shuffle(array) {\n      var currentIndex = array.length,\n          temporaryValue,\n          randomIndex; // While there remain elements to shuffle...\n\n      while (0 !== currentIndex) {\n        // Pick a remaining element...\n        randomIndex = Math.floor(Math.random() * currentIndex);\n        currentIndex -= 1; // And swap it with the current element.\n\n        temporaryValue = array[currentIndex];\n        array[currentIndex] = array[randomIndex];\n        array[randomIndex] = temporaryValue;\n      }\n\n      return array;\n    }\n\n    let newData = shuffle(oldData);\n    setBtnChangedData(newData);\n    setCurrentBtnClicked('random');\n  };\n\n  const more = async () => {\n    const result = await fetch(`http://localhost:3000/api/items/${currentPage}`);\n    const {\n      data\n    } = await result.json();\n    setCurrentPage(p => p + 4);\n    setHomeData(data); // Add to homeData\n\n    if (currentBtnClicked === 'latest') latest();\n    if (currentBtnClicked === 'popular') popular();\n    if (currentBtnClicked === 'under') under();\n    if (currentBtnClicked === 'random') random();\n    setBtnChangedData([]); // Reset and come back to homeData\n  };\n\n  return __jsx(Layout, {\n    mainPage: mainPage,\n    setMainPage: setMainPage\n  }, __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'container'\n  }, __jsx(\"div\", {\n    ref: sliderRef,\n    className: \"jsx-931979104\" + \" \" + 'keen-slider'\n  }, __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'keen-slider__slide number-slide1 slider-configuration'\n  }, __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'slider-box'\n  }, __jsx(\"img\", {\n    src: \"./slider/1.jpg\",\n    className: \"jsx-931979104\"\n  }), __jsx(\"p\", {\n    className: \"jsx-931979104\" + \" \" + 'slider-text slider-text-1'\n  }, \"PONAD 100 SKLEPOW\"))), __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'keen-slider__slide number-slide2 slider-configuration'\n  }, __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'slider-box'\n  }, __jsx(\"img\", {\n    src: \"./slider/2.jpg\",\n    className: \"jsx-931979104\"\n  }), __jsx(\"p\", {\n    className: \"jsx-931979104\" + \" \" + 'slider-text slider-text-2'\n  }, \"ZAWSZE POD REKA\"))), __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'keen-slider__slide number-slide3 slider-configuration'\n  }, __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'slider-box'\n  }, __jsx(\"img\", {\n    src: \"./slider/1.jpg\",\n    className: \"jsx-931979104\"\n  }), __jsx(\"p\", {\n    className: \"jsx-931979104\" + \" \" + 'slider-text slider-text-3'\n  }, \"NA KAZDA OKAZJE\"))), __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'keen-slider__slide number-slide4 slider-configuration'\n  }, __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'slider-box'\n  }, __jsx(\"img\", {\n    src: \"./slider/4.jpg\",\n    className: \"jsx-931979104\"\n  }), __jsx(\"p\", {\n    className: \"jsx-931979104\" + \" \" + 'slider-text slider-text-4'\n  }, \"WASZE CENTRUM\")))), __jsx(LatestNews, {\n    data: props.latestNewsData,\n    latest: latest\n  }), __jsx(Newsletter, null), __jsx(HomeNews, {\n    data: btnChangedData.length === 0 ? homeData : btnChangedData,\n    latest: latest,\n    popular: popular,\n    under: under,\n    random: random\n  })), __jsx(\"div\", {\n    className: \"jsx-931979104\" + \" \" + 'moreBtnDiv'\n  }, __jsx(\"button\", {\n    onClick: () => more(),\n    className: \"jsx-931979104\" + \" \" + 'btn'\n  }, \"WIECEJ\")), __jsx(_JSXStyle, {\n    id: \"931979104\"\n  }, [\".slider-configuration.jsx-931979104{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin:2rem 0;}\", \".slider-box.jsx-931979104{position:relative;}\", \".slider-text.jsx-931979104{position:absolute;font-size:3rem;width:34rem;line-height:3rem;text-shadow:1px 1px 0px rgba(0,0,0,0.2);padding:1rem 2rem;background-color:#ffc500;color:#fff;}\", \".slider-text-1.jsx-931979104{bottom:30rem;left:-5rem;white-space:nowrap;}\", \".slider-text-2.jsx-931979104{bottom:29rem;right:-1rem;}\", \".slider-text-3.jsx-931979104{bottom:3rem;left:-10rem;}\", \".slider-text-4.jsx-931979104{bottom:2rem;right:-3rem;}\", \".star.jsx-931979104{position:absolute;top:-54px;left:-57px;width:9%;-webkit-transform:rotate(-3deg);-ms-transform:rotate(-3deg);transform:rotate(-3deg);}\", \".moreBtnDiv.jsx-931979104{text-align:center;margin:3rem 0;}\", \".moreBtnDiv.jsx-931979104 button.jsx-931979104{padding:1rem 3rem;border:none;outline:none;}\", \".moreBtnDiv.jsx-931979104 button.jsx-931979104:hover{background-color:#ff2a2a;color:#fff;}\", \".moreBtnDiv.jsx-931979104 button.jsx-931979104:active{-webkit-transform:translateY(0.3rem);-ms-transform:translateY(0.3rem);transform:translateY(0.3rem);}\", \"@media only screen and (max-width:1024px){.slider-text-1.jsx-931979104{left:-1rem;}.slider-text-2.jsx-931979104{right:-3rem;}.slider-text-3.jsx-931979104{left:-1rem;}}\", \"@media only screen and (max-width:768px){.slider-box.jsx-931979104{position:relative;width:95%;margin:0 auto;}.slider-box.jsx-931979104 img.jsx-931979104{width:100%;}.slider-box.jsx-931979104 p.jsx-931979104{font-size:1.8rem;width:100%;padding:0.4rem 0;text-align:center;bottom:0;left:0;}}\", \"@media only screen and (max-width:510px){.slider-box.jsx-931979104 p.jsx-931979104{font-size:1.3rem;padding:.2rem 0;line-height:inherit;}}\"]));\n};\n\nexport const getStaticProps = async ctx => {\n  // https://nextjs.org/docs/basic-features/data-fetching#write-server-side-code-directly\n  dbConnect();\n  const items = await Item.find();\n  let onlyFive = items.slice(0, 9); // const latestNewsResult = await fetch('http://localhost:3000/api/all');\n  // const latestNewsData = await latestNewsResult.json();\n  // let itemsPerPage = await Item.find();\n\n  let n = items.slice(0, 4); // const homeNewsResult = await fetch(`http://localhost:3000/api/items/1`);\n  // const homeNewsData = await homeNewsResult.json();\n\n  return {\n    props: {\n      latestNewsData: JSON.parse(JSON.stringify(onlyFive)),\n      homeNewsData: JSON.parse(JSON.stringify(n))\n    },\n    revalidate: 1 //  static content can also be dynamic (ale jakby za 3 razem?). https://nextjs.org/docs/basic-features/data-fetching#getstaticprops-static-generation  \n\n  };\n};\nexport default Index;","map":null,"metadata":{},"sourceType":"module"}